---
export interface Props {
    /**
     * Y-scroll threshold (in px) before the button appears.
     */
    threshold?: number;
    /**
     * Accessible label for screen readers.
     */
    label?: string;
    /**
     * Distance from the bottom edge (any valid CSS length).
     */
    bottom?: string;
    /**
     * Distance from the right edge (any valid CSS length).
     */
    right?: string;
    /**
     * Button size in pixels (width/height are equal).
     */
    size?: number;
}

const {
    threshold = 300,
    label = "Posunúť hore",
    bottom = "1.25rem",
    right = "1.25rem",
    size = 48,
} = Astro.props;
import ArrowUpIcon from "../icons/ArrowUp.astro";
---

<button
    id="scrollTop"
    data-threshold={threshold}
    class="fixed bg-primary text-white border-none rounded-full cursor-pointer shadow-xl hidden transition-all duration-300 z-50 p-0 hover:bg-[#0b53d6] focus-visible:outline-none focus-visible:ring-4 focus-visible:ring-blue-500/20 active:scale-95 [&.show]:flex [&.show]:items-center [&.show]:justify-center"
    aria-label={label}
    title={label}
    style={`width:${size}px; height:${size}px; bottom:${bottom}; right:${right};`}
>
    <svg
        class="absolute inset-0 -rotate-90 pointer-events-none"
        width={size}
        height={size}
    >
        <circle
            cx={size / 2}
            cy={size / 2}
            r={(size - 6) / 2}
            stroke="rgba(255,255,255,0.2)"
            stroke-width="3"
            fill="none"
        />
        <circle
            id="scrollProgress"
            cx={size / 2}
            cy={size / 2}
            r={(size - 6) / 2}
            stroke="rgba(255,255,255,0.9)"
            stroke-width="3"
            fill="none"
            stroke-linecap="round"
            style={`stroke-dasharray: ${Math.PI * (size - 6)}; stroke-dashoffset: ${Math.PI * (size - 6)};`}
            class="transition-[stroke-dashoffset] duration-100 ease-out"
        />
    </svg>
    <ArrowUpIcon
        width={Math.round(size * 0.6)}
        height={Math.round(size * 0.6)}
        fill="currentColor"
    />
</button>

<style>
    /* Handled by Tailwind [&.show] class */
</style>

<script>
    import { initScrollTop } from "../../lib/components/scroll-top";
    initScrollTop();
</script>
