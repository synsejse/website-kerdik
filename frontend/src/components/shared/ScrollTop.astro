---
export interface Props {
    /**
     * Y-scroll threshold (in px) before the button appears.
     */
    threshold?: number;
    /**
     * Accessible label for screen readers.
     */
    label?: string;
    /**
     * Distance from the bottom edge (any valid CSS length).
     */
    bottom?: string;
    /**
     * Distance from the right edge (any valid CSS length).
     */
    right?: string;
    /**
     * Button size in pixels (width/height are equal).
     */
    size?: number;
}

const {
    threshold = 300,
    label = "Posunúť hore",
    bottom = "1.25rem",
    right = "1.25rem",
    size = 48,
} = Astro.props;
import ArrowUpIcon from "../icons/ArrowUp.astro";
---

<button
        id="scrollTop"
        data-threshold={threshold}
        class="fixed bg-primary text-white border-none rounded-full cursor-pointer shadow-xl hidden transition-all duration-300 z-50 p-0 hover:bg-[#0b53d6] focus-visible:outline-none focus-visible:ring-4 focus-visible:ring-blue-500/20 active:scale-95 [&.show]:flex [&.show]:items-center [&.show]:justify-center"
        aria-label={label}
        title={label}
        style={`width:${size}px; height:${size}px; bottom:${bottom}; right:${right};`}
>
    <ArrowUpIcon width={Math.round(size * 0.6)} height={Math.round(size * 0.6)} fill="currentColor"/>
</button>

<style>
    /* Handled by Tailwind [&.show] class */
</style>

<script>
    if (typeof window !== "undefined") {
        const btn = document.getElementById("scrollTop");
        const scrollThreshold = parseInt(btn?.dataset.threshold || "300", 10);

        function onScroll() {
            if (!btn) return;
            if (window.scrollY > scrollThreshold) {
                btn.classList.add("show");
            } else {
                btn.classList.remove("show");
            }
        }

        window.addEventListener("scroll", onScroll, {passive: true});
        // Initialize state on load
        onScroll();

        btn?.addEventListener("click", () => {
            try {
                window.scrollTo({top: 0, behavior: "smooth"});
            } catch {
                // Fallback for older browsers
                window.scrollTo(0, 0);
            }
        });
    }
</script>
